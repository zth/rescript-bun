// Generated by ReScript, PLEASE EDIT WITH CARE

import * as $$Bun from "bun";
import * as SQL$RescriptBun from "rescript-bun/src/SQL.js";

let db = new $$Bun.SQL({
  filename: ":memory:",
  adapter: "sqlite"
});

await SQL$RescriptBun.query(db, [`
  CREATE TABLE users (
      name TEXT NOT NULL,
      email TEXT PRIMARY KEY
  );
`], []);

async function insertUser(name, email) {
  return await SQL$RescriptBun.query(db, [
    `
  INSERT INTO users (name, email) 
  VALUES (`,
    `, `,
    `)
  RETURNING *
`
  ], [
    name,
    email
  ]);
}

let userData = {
  name: "Alice",
  email: "alice@example.com"
};

let newUser = await SQL$RescriptBun.query(db, [
  `
  INSERT INTO users `,
  `
  RETURNING *
`
], [SQL$RescriptBun.object(db, userData, [
    "name",
    "email"
  ])]);

console.log(newUser);

await insertUser("Bob", "bob@email.com");

let users = await SQL$RescriptBun.query(db, [`SELECT * FROM users`], []);

if (Array.isArray(users)) {
  console.log(users);
}

export {
  db,
  insertUser,
  userData,
  newUser,
}
/* db Not a pure module */
